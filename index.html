<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jalen's Story Review</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #f3f4f6;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .match-card {
            cursor: pointer;
            transition: all 0.2s;
        }
        .selected {
            border-color: #6366f1 !important;
            background-color: #eef2ff !important;
        }
        .matched {
            opacity: 0.5;
            cursor: default;
            pointer-events: none;
            background-color: #f0fdf4 !important;
            border-color: #22c55e !important;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div id="game-container" class="bg-white p-8 rounded-2xl shadow-xl max-w-2xl w-full fade-in">
        <!-- Header -->
        <div class="mb-8 text-center">
            <h1 id="main-title" class="text-3xl font-bold text-indigo-600 mb-2">R√©vision de l'histoire</h1>
            <p id="main-desc" class="text-gray-600">Commen√ßons par le vocabulaire !</p>
            <div id="progress-container" class="w-full bg-gray-200 h-2 mt-4 rounded-full overflow-hidden">
                <div id="progress-fill" class="bg-indigo-500 h-full transition-all duration-300" style="width: 0%"></div>
            </div>
        </div>

        <!-- Vocabulary Matching Section -->
        <div id="vocab-section">
            <h3 class="text-lg font-semibold text-gray-700 mb-4 text-center">Associez les mots fran√ßais √† leur sens anglais</h3>
            <div class="grid grid-cols-2 gap-4">
                <div id="french-cols" class="space-y-2"></div>
                <div id="english-cols" class="space-y-2"></div>
            </div>
            <button id="start-quiz-btn" class="mt-8 w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition-colors hidden">
                Continuer vers le Quiz
            </button>
        </div>

        <!-- Question Section (Hidden initially) -->
        <div id="quiz-section" class="hidden">
            <div class="mb-6">
                <span id="question-number" class="text-sm font-semibold text-indigo-400 uppercase tracking-wider">Question 1/10</span>
                <h2 id="question-text" class="text-xl font-medium text-gray-800 mt-2">Chargement...</h2>
            </div>
            <div id="options-container" class="space-y-3"></div>
            <div id="feedback" class="mt-6 p-4 rounded-lg hidden"></div>
            <button id="next-btn" class="mt-6 w-full bg-indigo-600 text-white py-3 rounded-xl font-bold hover:bg-indigo-700 transition-colors hidden">
                Suivant
            </button>
        </div>

        <!-- Result Section -->
        <div id="result-section" class="hidden text-center py-8">
            <div class="text-6xl mb-4">üèÜ</div>
            <h2 class="text-3xl font-bold text-gray-800 mb-2">F√©licitations !</h2>
            <p class="text-xl text-gray-600 mb-6">Vous avez termin√© l'entra√Ænement.</p>
            <p class="text-lg text-gray-500 mb-6">Score Quiz : <span id="final-score" class="font-bold text-indigo-600">0</span>/10</p>
            <button onclick="location.reload()" class="bg-indigo-600 text-white px-8 py-3 rounded-xl font-bold hover:bg-indigo-700 transition-colors">
                Recommencer
            </button>
        </div>
    </div>

    <script>
        const vocabData = [
            { fr: "Petite-amie", en: "Girlfriend" },
            { fr: "F√¢ch√©", en: "Angry" },
            { fr: "Diamants", en: "Diamonds" },
            { fr: "Il a pris", en: "He took" },
            { fr: "Ind√©pendante", en: "Independent" },
            { fr: "Un chien", en: "A dog" }
        ];

        const quizData = [
            {
                question: "Qui est le personnage principal de l'histoire ?",
                options: ["Le fr√®re", "Jalen", "Rebeca", "Denisha"],
                correct: 1
            },
            {
                question: "Au d√©but, comment s'appelle la petite-amie de Jalen ?",
                options: ["Denisha", "Sa m√®re", "Rebeca", "Elle n'a pas de nom"],
                correct: 2
            },
            {
                question: "Qu'est-ce que le fr√®re de Jalen apporte √† Rebeca ?",
                options: ["Des fleurs", "Des chocolats", "Un animal domestique", "Des diamants"],
                correct: 2
            },
            {
                question: "Quel animal le fr√®re donne-t-il √† Rebeca ?",
                options: ["Un rat", "Un chat", "Un oiseau", "Un chien"],
                correct: 3
            },
            {
                question: "Pourquoi Jalen va-t-il dans le New Jersey ?",
                options: ["Pour travailler", "Parce qu'il n'a plus de petite-amie", "Pour voir son fr√®re", "Pour acheter un chien"],
                correct: 1
            },
            {
                question: "Comment Jalen d√©crit-il Denisha ?",
                options: ["Belle et riche", "Triste et f√¢ch√©e", "Intelligente et ind√©pendante", "Petite et adorable"],
                correct: 2
            },
            {
                question: "O√π est-ce que Jalen rencontre Denisha ?",
                options: ["Dans un caf√©", "Dans un parc", "√Ä l'√©cole", "Chez lui"],
                correct: 0
            },
            {
                question: "Qu'est-ce que le fr√®re a pris √† sa m√®re ?",
                options: ["De l'argent", "Des roses", "Un chien", "Des diamants"],
                correct: 3
            },
            {
                question: "Est-ce que Denisha veut √™tre la petite-amie du fr√®re ?",
                options: ["Oui, parce qu'il est gentil", "Non, elle veut seulement les diamants", "Oui, elle adore les diamants", "Elle ne r√©pond pas"],
                correct: 1
            },
            {
                question: "√Ä la fin, pourquoi le fr√®re est-il f√¢ch√© ?",
                options: ["Il a perdu son chien", "Jalen est dans le New Jersey", "Il n'a plus de diamants et pas de petite-amie", "Sa m√®re est f√¢ch√©e"],
                correct: 2
            }
        ];

        let selectedFr = null;
        let selectedEn = null;
        let matchedCount = 0;
        let currentQuestion = 0;
        let score = 0;
        let canAnswer = true;

        // UI Elements
        const vocabSection = document.getElementById('vocab-section');
        const quizSection = document.getElementById('quiz-section');
        const startQuizBtn = document.getElementById('start-quiz-btn');
        const frenchCols = document.getElementById('french-cols');
        const englishCols = document.getElementById('english-cols');

        // Initial Vocab setup
        function initVocab() {
            const shuffledFr = [...vocabData].sort(() => Math.random() - 0.5);
            const shuffledEn = [...vocabData].sort(() => Math.random() - 0.5);

            shuffledFr.forEach(item => {
                const div = createMatchCard(item.fr, 'fr');
                frenchCols.appendChild(div);
            });

            shuffledEn.forEach(item => {
                const div = createMatchCard(item.en, 'en');
                englishCols.appendChild(div);
            });
        }

        function createMatchCard(text, lang) {
            const div = document.createElement('div');
            div.innerText = text;
            div.className = "match-card p-3 border-2 border-gray-200 rounded-lg text-center font-medium bg-white";
            div.onclick = () => handleMatchClick(div, text, lang);
            return div;
        }

        function handleMatchClick(element, text, lang) {
            if (element.classList.contains('matched')) return;

            if (lang === 'fr') {
                document.querySelectorAll('#french-cols .match-card').forEach(c => c.classList.remove('selected'));
                selectedFr = { element, text };
                element.classList.add('selected');
            } else {
                document.querySelectorAll('#english-cols .match-card').forEach(c => c.classList.remove('selected'));
                selectedEn = { element, text };
                element.classList.add('selected');
            }

            if (selectedFr && selectedEn) {
                const match = vocabData.find(v => v.fr === selectedFr.text && v.en === selectedEn.text);
                if (match) {
                    selectedFr.element.classList.add('matched');
                    selectedEn.element.classList.add('matched');
                    matchedCount++;
                    if (matchedCount === vocabData.length) {
                        startQuizBtn.classList.remove('hidden');
                    }
                }
                
                // Reset selection
                setTimeout(() => {
                    selectedFr.element.classList.remove('selected');
                    selectedEn.element.classList.remove('selected');
                    selectedFr = null;
                    selectedEn = null;
                }, 300);
            }
        }

        startQuizBtn.onclick = () => {
            vocabSection.classList.add('hidden');
            quizSection.classList.remove('hidden');
            document.getElementById('main-title').innerText = "Le Quiz";
            document.getElementById('main-desc').innerText = "R√©pondez aux questions sur l'histoire";
            loadQuestion();
        };

        // Quiz Logic (Original)
        function loadQuestion() {
            canAnswer = true;
            const data = quizData[currentQuestion];
            document.getElementById('question-number').innerText = `Question ${currentQuestion + 1}/${quizData.length}`;
            document.getElementById('question-text').innerText = data.question;
            document.getElementById('progress-fill').style.width = `${((currentQuestion) / quizData.length) * 100}%`;
            
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            document.getElementById('feedback').classList.add('hidden');
            document.getElementById('next-btn').classList.add('hidden');

            data.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.innerText = option;
                button.className = "w-full text-left p-4 rounded-xl border-2 border-gray-100 hover:border-indigo-300 hover:bg-indigo-50 transition-all duration-200 text-gray-700 font-medium";
                button.onclick = () => checkAnswer(index);
                optionsContainer.appendChild(button);
            });
        }

        function checkAnswer(selectedIndex) {
            if (!canAnswer) return;
            canAnswer = false;

            const correctIndex = quizData[currentQuestion].correct;
            const buttons = document.getElementById('options-container').getElementsByTagName('button');

            if (selectedIndex === correctIndex) {
                score++;
                buttons[selectedIndex].classList.add('bg-green-100', 'border-green-500', 'text-green-700');
                showFeedback("Excellent ! C'est correct.", true);
            } else {
                buttons[selectedIndex].classList.add('bg-red-100', 'border-red-500', 'text-red-700');
                buttons[correctIndex].classList.add('bg-green-100', 'border-green-500', 'text-green-700');
                showFeedback("Dommage ! La bonne r√©ponse √©tait : " + quizData[currentQuestion].options[correctIndex], false);
            }

            document.getElementById('next-btn').classList.remove('hidden');
            if (currentQuestion === quizData.length - 1) {
                document.getElementById('next-btn').innerText = "Voir les r√©sultats";
            }
        }

        function showFeedback(message, isCorrect) {
            const feedback = document.getElementById('feedback');
            feedback.innerText = message;
            feedback.className = `mt-6 p-4 rounded-lg font-medium ${isCorrect ? 'bg-green-50 text-green-800' : 'bg-red-50 text-red-800'}`;
            feedback.classList.remove('hidden');
        }

        document.getElementById('next-btn').onclick = () => {
            currentQuestion++;
            if (currentQuestion < quizData.length) {
                loadQuestion();
            } else {
                showResults();
            }
        };

        function showResults() {
            quizSection.classList.add('hidden');
            document.getElementById('result-section').classList.remove('hidden');
            document.getElementById('progress-fill').style.width = '100%';
            document.getElementById('final-score').innerText = score;
        }

        window.onload = initVocab;
    </script>
</body>
</html>
